#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

# Pre-commit hook that validates code quality before allowing commits
# Phases:
# 1. Type checking (core + foundry)
# 2. Test suite
# 3. Build verification
# If any phase fails, the commit is aborted

echo "ğŸ” Phase 1: Type checking..."
npm run type-check:all || (echo "âŒ Type check failed! Commit aborted."; exit 1)

echo ""
echo "ğŸ§ª Phase 2: Running tests..."
npm test -- --run || (echo "âŒ Tests failed! Commit aborted."; exit 1)

echo ""
echo "ğŸ”¨ Phase 3: Building..."
npm run build:all || (echo "âŒ Build failed! Commit aborted."; exit 1)

echo ""
echo "âœ… All checks passed! Commit allowed."
