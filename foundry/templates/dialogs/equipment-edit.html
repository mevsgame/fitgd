<div class="equipment-edit-dialog">
  {{!-- Header --}}
  <div class="dialog-header">
    {{#if (eq mode 'create')}}
    <h2>Create Equipment</h2>
    <p class="info-notice">üì¶ Create a new equipment item for this character</p>
    {{else}}
    <h2>Edit Equipment</h2>
    <p class="info-notice">üì¶ Configure equipment stats and modifiers</p>
    {{/if}}

    {{!-- Player tier restriction warning --}}
    {{#unless isGM}}
    {{#unless canEditTier}}
    <div class="warning-notice">
      ‚ö†Ô∏è You can only create or edit Common tier equipment. Rare and Epic items are GM-controlled.
    </div>
    {{/unless}}
    {{/unless}}
  </div>

  {{!-- Equipment Form --}}
  <form class="equipment-form">
    <div class="form-group">
      <label>Name <span class="required">*</span></label>
      <input type="text" name="name" value="{{equipment.name}}" maxlength="50" required />
      <p class="help-text">Equipment name (max 50 characters)</p>
    </div>

    <div class="form-group">
      <label>Tier <span class="required">*</span></label>
      <select name="tier" {{#unless canEditTier}}disabled{{/unless}}>
        {{#each tiers}}
        <option value="{{this}}" {{#if (eq this ../equipment.tier)}}selected{{/if}}>{{capitalize this}}</option>
        {{/each}}
      </select>
      <p class="help-text">
        <strong>Common:</strong> Standard gear, freely available<br />
        <strong>Rare:</strong> Requires 1M on first use (between Resets)<br />
        <strong>Epic:</strong> Must be earned through story
        {{#unless isGM}}
        {{#unless canEditTier}}
        <br /><strong>‚ö†Ô∏è Players can only create Common tier equipment</strong>
        {{/unless}}
        {{/unless}}
      </p>
    </div>

    <div class="form-group">
      <label>Category <span class="required">*</span></label>
      <select name="category" required>
        {{#each categories}}
        <option value="{{this}}" {{#if (eq this ../equipment.category)}}selected{{/if}}>{{capitalize this}}</option>
        {{/each}}
      </select>
      <p class="help-text">
        <strong>Active:</strong> Player selects in roll (weapons, tools, devices)<br />
        <strong>Passive:</strong> GM approves during roll (armor, implants, augmentations)<br />
        <strong>Consumable:</strong> Single-use items (grenades, stims, medkits)
      </p>
    </div>

    <div class="form-group">
      <label>Slots <span class="required">*</span></label>
      <input type="number" name="slots" value="{{equipment.slots}}" min="1" required />
      <p class="help-text">Load slots occupied (minimum 1, default 5 slots per character)</p>
    </div>

    <div class="form-group">
      <label>Description</label>
      <textarea name="description" rows="4"
        placeholder="Describe the equipment and how it affects gameplay...">{{equipment.description}}</textarea>
      <p class="help-text">Include narrative details and mechanical effects on Position/Effect</p>
    </div>

    <div class="form-group">
      <label>Modifiers</label>
      <p class="help-text">Configure how this equipment affects rolls when used</p>
      <div class="modifiers-grid">
        <div class="modifier-field">
          <label>Dice Bonus</label>
          <input type="number" name="modifiers.diceBonus" value="{{equipment.modifiers.diceBonus}}" placeholder="0" min="0" />
          <p class="help-text-small">Additional dice in pool (default 1)</p>
        </div>
        <div class="modifier-field">
          <label>Dice Penalty</label>
          <input type="number" name="modifiers.dicePenalty" value="{{equipment.modifiers.dicePenalty}}" placeholder="0" min="0" />
          <p class="help-text-small">Dice to remove from pool</p>
        </div>
        <div class="modifier-field">
          <label>Position Bonus</label>
          <input type="number" name="modifiers.positionBonus" value="{{equipment.modifiers.positionBonus}}" placeholder="0" min="0" max="1" />
          <p class="help-text-small">Improve position by N steps</p>
        </div>
        <div class="modifier-field">
          <label>Position Penalty</label>
          <input type="number" name="modifiers.positionPenalty" value="{{equipment.modifiers.positionPenalty}}" placeholder="0" min="0" max="1" />
          <p class="help-text-small">Worsen position by N steps</p>
        </div>
        <div class="modifier-field">
          <label>Effect Bonus</label>
          <input type="number" name="modifiers.effectBonus" value="{{equipment.modifiers.effectBonus}}" placeholder="0" min="0" max="1" />
          <p class="help-text-small">Improve effect by N levels</p>
        </div>
        <div class="modifier-field">
          <label>Effect Penalty</label>
          <input type="number" name="modifiers.effectPenalty" value="{{equipment.modifiers.effectPenalty}}" placeholder="0" min="0" max="1" />
          <p class="help-text-small">Reduce effect by N levels</p>
        </div>
      </div>
    </div>

  </form>

  {{!-- Action Buttons --}}
  <div class="dialog-buttons">
    <button type="button" class="secondary cancel-btn">
      <i class="fas fa-times"></i> Cancel
    </button>
    <button type="submit" class="primary save-btn">
      {{#if (eq mode 'create')}}
      <i class="fas fa-plus"></i> Create Equipment
      {{else}}
      <i class="fas fa-save"></i> Save Changes
      {{/if}}
    </button>
  </div>
</div>