<div class="equipment-edit-dialog">
  {{!-- Header --}}
  <div class="dialog-header">
    <h2>Edit Equipment</h2>
    <p class="info-notice">ðŸ“¦ Configure equipment stats and modifiers</p>
  </div>

  {{!-- Equipment Form --}}
  <form class="equipment-form">
    <div class="form-group">
      <label>Name</label>
      <input type="text" name="name" value="{{equipment.name}}" required />
    </div>

    <div class="form-group">
      <label>Tier</label>
      <select name="tier">
        {{#each tiers}}
        <option value="{{this}}" {{#if (eq this ../equipment.tier)}}selected{{/if}}>{{this}}</option>
        {{/each}}
      </select>
      <p class="help-text">
        <strong>Accessible:</strong> Standard gear, freely available<br />
        <strong>Inaccessible:</strong> Requires flashback (1 Momentum + trait)<br />
        <strong>Epic:</strong> Must be earned through story
      </p>
    </div>

    <div class="form-group">
      <label>Category</label>
      <select name="category">
        {{#each categories}}
        <option value="{{this}}" {{#if (eq this ../equipment.category)}}selected{{/if}}>{{this}}</option>
        {{/each}}
      </select>
      <p class="help-text">Choose the primary type of this equipment (Weapon, Armor, Tool, Consumable, Misc)</p>
    </div>

    <div class="form-group">
      <label>Description</label>
      <textarea name="description" rows="4"
        placeholder="Describe the equipment and how it affects gameplay...">{{equipment.description}}</textarea>
      <p class="help-text">Include narrative details and mechanical effects on Position/Effect</p>
    </div>

    <div class="form-group">
      <label>Modifiers</label>
      <p class="help-text">Configure how this equipment affects rolls when used</p>
      <div class="modifiers-grid">
        <div class="modifier-field">
          <label>Position</label>
          <select name="modifiers.position">
            <option value="none" {{#if (eq equipment.modifiers.position "none" )}}selected{{/if}}>None</option>
            <option value="plus_one_step" {{#if (eq equipment.modifiers.position "plus_one_step" )}}selected{{/if}}>+1
              Step (Desperateâ†’Risky or Riskyâ†’Controlled)</option>
            <option value="minus_one_step" {{#if (eq equipment.modifiers.position "minus_one_step" )}}selected{{/if}}>-1
              Step (Controlledâ†’Risky or Riskyâ†’Desperate)</option>
          </select>
        </div>
        <div class="modifier-field">
          <label>Effect</label>
          <select name="modifiers.effect">
            <option value="none" {{#if (eq equipment.modifiers.effect "none" )}}selected{{/if}}>None</option>
            <option value="plus_one_level" {{#if (eq equipment.modifiers.effect "plus_one_level" )}}selected{{/if}}>+1
              Level (Limitedâ†’Standard or Standardâ†’Great)</option>
            <option value="minus_one_level" {{#if (eq equipment.modifiers.effect "minus_one_level" )}}selected{{/if}}>-1
              Level (Greatâ†’Standard or Standardâ†’Limited)</option>
          </select>
        </div>
        <div class="modifier-field">
          <label>Dice Pool</label>
          <input type="number" name="modifiers.dicePool" value="{{equipment.modifiers.dicePool}}" placeholder="0" />
          <p class="help-text-small">Additional dice (e.g., +1 for fine weapons)</p>
        </div>
      </div>
    </div>

    <div class="form-group">
      <label>Image Path</label>
      <input type="text" name="img" value="{{equipment.img}}"
        placeholder="systems/forged-in-the-grimdark/assets/items/..." />
      <p class="help-text">Path to item image (or leave empty for default icon)</p>
    </div>

    {{#if equipment.sourceItemId}}
    <div class="form-group">
      <label>ðŸ“‹ Source Template</label>
      <input type="text" value="{{equipment.sourceItemId}}" disabled />
      <p class="help-text">Original template ID (for reference only)</p>
    </div>
    {{/if}}

    {{#if equipment.acquiredAt}}
    <div class="form-group">
      <label>ðŸ“… Acquired</label>
      <p class="equipment-meta">
        {{#if equipment.acquiredVia}}
        Via <strong>{{equipment.acquiredVia}}</strong>
        {{/if}}
        on <time datetime="{{equipment.acquiredAt}}">{{formatTimestamp equipment.acquiredAt}}</time>
      </p>
    </div>
    {{/if}}
  </form>

  {{!-- Action Buttons --}}
  <div class="dialog-buttons">
    <button type="button" class="secondary cancel-btn">
      <i class="fas fa-times"></i> Cancel
    </button>
    <button type="submit" class="primary save-btn">
      <i class="fas fa-save"></i> Save Changes
    </button>
  </div>
</div>