<form class="{{cssClass}} flexcol" autocomplete="off">

  {{!-- Sheet Header --}}
  <header class="sheet-header">
    <img class="profile-img" src="{{actor.img}}" data-edit="img" title="{{actor.name}}" height="100" width="100" />
    <div class="header-fields">
      <h1 class="crewname"><input name="name" type="text" value="{{actor.name}}" placeholder="Crew Name" /></h1>

      {{!-- Momentum Display --}}
      <div class="momentum-display">
        <label>{{localize "FITGD.Crew.Momentum"}}</label>
        <div class="momentum-row">
          <div class="momentum-track">
            {{#times 10}}
            <span class="momentum-box {{#if (lt this ../system.currentMomentum)}}filled{{/if}}">
              {{#if (eq this ../system.currentMomentum)}}â–¶{{/if}}
            </span>
            {{/times}}
          </div>
          <div class="momentum-value">{{system.currentMomentum}}/10</div>

          <button class="momentum-add-btn" type="button" data-amount="1"
            title="{{localize 'FITGD.Momentum.AddTooltip'}}">
            <i class="fas fa-plus"></i>
          </button>
          <button class="momentum-spend-btn" type="button" data-amount="1"
            title="{{localize 'FITGD.Momentum.SpendTooltip'}}">
            <i class="fas fa-minus"></i>
          </button>
          {{#if @root.editable}}
          <button class="momentum-reset-btn" type="button" title="{{localize 'FITGD.Momentum.ResetTooltip'}}">
            <i class="fas fa-redo"></i>
          </button>
          {{/if}}
        </div>
      </div>

      {{!-- HUD Primary Crew Toggle (GM only) --}}
      {{#if @root.editable}}
      <div class="hud-controls">
        <button class="set-primary-btn {{#if isPrimary}}active{{/if}}" type="button"
          title="{{#if isPrimary}}{{localize 'FITGD.Crew.PrimaryHUDTooltip'}}{{else}}{{localize 'FITGD.Crew.SetPrimaryHUDTooltip'}}{{/if}}">
          <i class="fas fa-star{{#unless isPrimary}}-half-alt{{/unless}}"></i>
          {{#if isPrimary}}{{localize "FITGD.Crew.PrimaryHUD"}}{{else}}{{localize "FITGD.Crew.SetPrimaryHUD"}}{{/if}}
        </button>
      </div>
      {{/if}}
    </div>
  </header>

  {{!-- Sheet Tab Navigation --}}
  <nav class="sheet-tabs tabs" data-group="primary">
    <a class="item" data-tab="members">{{localize "FITGD.Crew.Members"}}</a>
    <a class="item" data-tab="clocks">{{localize "FITGD.Crew.Clocks"}}</a>
  </nav>

  {{!-- Sheet Body --}}
  <section class="sheet-body">

    {{!-- Members Tab --}}
    <div class="tab members" data-group="primary" data-tab="members">
      <div class="members-header">
        <h2>{{localize "FITGD.Crew.CrewMembers"}}</h2>
        <div class="header-buttons">
          <button class="add-character-btn" type="button">
            <i class="fas fa-user-plus"></i> {{localize "FITGD.Crew.AddCharacter"}}
          </button>
        </div>
      </div>
      <div class="members-list">
        {{#each system.characters as |character|}}
        <div class="member-item">
          <div class="member-info">
            {{#if character.foundryActorId}}
            <a class="content-link" draggable="true" data-uuid="Actor.{{character.foundryActorId}}"
              data-id="{{character.foundryActorId}}" data-type="Actor">
              <i class="fas fa-user"></i> {{character.name}}
            </a>
            {{else}}
            <span><i class="fas fa-user"></i> {{character.name}}</span>
            {{/if}}
          </div>
          {{#if @root.editable}}
          <button class="remove-character-btn" type="button" data-character-id="{{character.id}}"
            title="{{localize 'FITGD.Crew.RemoveFromCrew'}}">
            <i class="fas fa-times"></i>
          </button>
          {{/if}}
        </div>
        {{/each}}

        {{#unless system.characters.length}}
        <p class="no-members">{{localize "FITGD.Crew.NoMembers"}}</p>
        {{/unless}}
      </div>
    </div>

    {{!-- Clocks Tab --}}
    <div class="tab clocks" data-group="primary" data-tab="clocks">
      <div class="clocks-header">
        <h2>{{localize "FITGD.Crew.ProgressClocks"}}</h2>
        <div class="header-buttons">
          <button class="add-clock-btn" type="button">
            <i class="fas fa-clock"></i> {{localize "FITGD.Clocks.Add"}}
          </button>
        </div>
      </div>

      {{!-- Progress Clocks --}}
      {{#if system.progressClocks}}
      <div class="clock-section">
        <h3>{{localize "FITGD.Crew.ProgressThreatClocks"}}</h3>
        <div class="clocks-flow-grid">
          {{#each system.progressClocks as |clock|}}
          <div class="clock-item progress-clock" data-clock-id="{{clock.id}}" data-category="{{clock.category}}">
            <div class="clock-info">
              <div class="clock-header-inline">
                <h4 class="clock-name {{#if @root.editable}}editable{{/if}}" data-clock-id="{{clock.id}}"
                  contenteditable="{{@root.editable}}">{{clock.name}}</h4>
                {{#if @root.editable}}
                <button class="delete-clock-btn" type="button" data-clock-id="{{clock.id}}"
                  title="{{localize 'FITGD.Clocks.Delete'}}">
                  <i class="fas fa-trash"></i>
                </button>
                {{/if}}
              </div>
              <span class="clock-category">{{clock.category}}</span>
              <div class="clock-controls">
                {{#if @root.editable}}
                <input type="number" class="clock-value-input" data-clock-id="{{clock.id}}" value="{{clock.segments}}"
                  min="0" max="{{clock.maxSegments}}" title="{{localize 'FITGD.Clocks.ValueTooltip'}}" />
                {{else}}
                <span class="clock-value">{{clock.segments}}/{{clock.maxSegments}}</span>
                {{/if}}
              </div>
              {{#if clock.description}}
              <p class="clock-description">{{clock.description}}</p>
              {{/if}}
            </div>
            <div class="clock-display">
              {{clockSVG clock width="100px" height="100px" class="progress-clock-svg"}}
            </div>
          </div>
          {{/each}}
        </div>
      </div>
      {{/if}}
    </div>

  </section>
</form>