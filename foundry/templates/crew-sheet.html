<form class="{{cssClass}} flexcol" autocomplete="off">

  {{!-- Sheet Header --}}
  <header class="sheet-header">
    <img class="profile-img" src="{{actor.img}}" data-edit="img" title="{{actor.name}}" height="100" width="100"/>
    <div class="header-fields">
      <h1 class="crewname"><input name="name" type="text" value="{{actor.name}}" placeholder="Crew Name"/></h1>

      {{!-- Momentum Display --}}
      <div class="momentum-display">
        <label>Momentum</label>
        <div class="momentum-track">
          {{#times 10}}
            <span class="momentum-box {{#if (lt this ../system.currentMomentum)}}filled{{/if}}">
              {{#if (eq this ../system.currentMomentum)}}â–¶{{/if}}
            </span>
          {{/times}}
        </div>
        <div class="momentum-value">{{system.currentMomentum}}/10</div>
        <div class="momentum-controls">
          <button class="momentum-add-btn" type="button" data-amount="1" title="Add 1 Momentum">
            <i class="fas fa-plus"></i>
          </button>
          <button class="momentum-spend-btn" type="button" data-amount="1" title="Spend 1 Momentum">
            <i class="fas fa-minus"></i>
          </button>
        </div>
      </div>
    </div>
  </header>

  {{!-- Sheet Tab Navigation --}}
  <nav class="sheet-tabs tabs" data-group="primary">
    <a class="item" data-tab="members">Members</a>
    <a class="item" data-tab="clocks">Clocks</a>
    <a class="item" data-tab="actions">Actions</a>
  </nav>

  {{!-- Sheet Body --}}
  <section class="sheet-body">

    {{!-- Members Tab --}}
    <div class="tab members" data-group="primary" data-tab="members">
      <div class="members-header">
        <h2>Crew Members</h2>
        <button class="add-character-btn" type="button">
          <i class="fas fa-user-plus"></i> Add Character
        </button>
      </div>
      <div class="members-list">
        {{#each system.characters as |character|}}
        <div class="member-item">
          {{#if character.foundryActorId}}
          <a class="content-link" draggable="true" data-uuid="Actor.{{character.foundryActorId}}" data-id="{{character.foundryActorId}}" data-type="Actor">
            <i class="fas fa-user"></i> {{character.name}}
          </a>
          {{else}}
          <span><i class="fas fa-user"></i> {{character.name}}</span>
          {{/if}}
        </div>
        {{/each}}

        {{#unless system.characters.length}}
        <p class="no-members">No crew members yet. Use the Add Character button above.</p>
        {{/unless}}
      </div>
    </div>

    {{!-- Clocks Tab --}}
    <div class="tab clocks" data-group="primary" data-tab="clocks">
      <div class="clocks-header">
        <h2>Progress Clocks</h2>
        <button class="add-clock-btn" type="button">
          <i class="fas fa-clock"></i> Add Clock
        </button>
      </div>

      {{!-- Addiction Clock --}}
      {{#if system.addictionClock}}
      <div class="clock-section">
        <h3>Addiction Clock</h3>
        <div class="clock-item addiction-clock">
          <div class="clock-display large">
            <div class="clock-segments">
              {{#times system.addictionClock.maxSegments}}
                <span class="clock-segment {{#if (lt this ../system.addictionClock.segments)}}filled{{/if}}"
                      data-clock-id="{{../system.addictionClock.id}}"
                      data-segment="{{this}}"
                      data-current-segments="{{../system.addictionClock.segments}}">
                </span>
              {{/times}}
            </div>
            <span class="clock-value">{{system.addictionClock.segments}}/{{system.addictionClock.maxSegments}}</span>
          </div>
          {{#if (gte system.addictionClock.segments system.addictionClock.maxSegments)}}
          <p class="warning"><i class="fas fa-exclamation-triangle"></i> Stims are locked due to addiction!</p>
          {{/if}}
        </div>
      </div>
      {{/if}}

      {{!-- Consumable Clocks --}}
      {{#if system.consumableClocks}}
      <div class="clock-section">
        <h3>Consumables</h3>
        <div class="clocks-grid">
          {{#each system.consumableClocks as |clock|}}
          <div class="clock-item consumable-clock {{#if clock.metadata.frozen}}frozen{{/if}}">
            <h4>{{clock.subtype}}</h4>
            <span class="clock-rarity">{{clock.metadata.rarity}}</span>
            <div class="clock-display">
              <div class="clock-segments">
                {{#times clock.maxSegments}}
                  <span class="clock-segment {{#if (lt this ../clock.segments)}}filled{{/if}}"
                        data-clock-id="{{../clock.id}}"
                        data-segment="{{this}}"
                        data-current-segments="{{../clock.segments}}">
                  </span>
                {{/times}}
              </div>
              <span class="clock-value">{{clock.segments}}/{{clock.maxSegments}}</span>
            </div>
            {{#if clock.metadata.frozen}}
            <p class="clock-status"><i class="fas fa-snowflake"></i> Depleted</p>
            {{/if}}
          </div>
          {{/each}}
        </div>
      </div>
      {{/if}}

      {{!-- Progress Clocks --}}
      {{#if system.progressClocks}}
      <div class="clock-section">
        <h3>Progress & Threat Clocks</h3>
        <div class="clocks-grid">
          {{#each system.progressClocks as |clock|}}
          <div class="clock-item progress-clock">
            <h4>{{clock.name}}</h4>
            <span class="clock-category">{{clock.category}}</span>
            <div class="clock-display">
              <div class="clock-segments">
                {{#times clock.maxSegments}}
                  <span class="clock-segment {{#if (lt this ../clock.segments)}}filled{{/if}}"
                        data-clock-id="{{../clock.id}}"
                        data-segment="{{this}}"
                        data-current-segments="{{../clock.segments}}">
                  </span>
                {{/times}}
              </div>
              <span class="clock-value">{{clock.segments}}/{{clock.maxSegments}}</span>
            </div>
            {{#if clock.description}}
            <p class="clock-description">{{clock.description}}</p>
            {{/if}}
          </div>
          {{/each}}
        </div>
      </div>
      {{/if}}
    </div>

    {{!-- Actions Tab --}}
    <div class="tab actions" data-group="primary" data-tab="actions">
      <h2>Crew Actions</h2>

      <div class="action-section">
        <h3>Push Yourself</h3>
        <p class="help-text">Spend 1 Momentum to gain an advantage on a roll.</p>
        <button class="push-btn" type="button">
          <i class="fas fa-bolt"></i> Push Yourself
        </button>
      </div>

      <div class="action-section">
        <h3>Reset</h3>
        <p class="help-text">Reset Momentum to 5, reduce Addiction by 2, restore Rally for all characters.</p>
        <button class="reset-btn" type="button">
          <i class="fas fa-redo"></i> Perform Reset
        </button>
      </div>
    </div>

  </section>
</form>
